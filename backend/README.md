# Backend PriceAlchemists

Серверная часть сервиса для определения цены товара по изображению.

## Структура проекта

```
backend/
├── app/
│   ├── models/          # Модели машинного обучения
│   │   ├── faiss.py    # Поиск похожих товаров
│   │   ├── sam.py      # Сегментация изображений
│   │   └── price_predictor.py  # Предсказание цены
│   ├── utils/          # Вспомогательные функции
│   │   └── images.py   # Обработка изображений
│   ├── templates/      # HTML шаблоны
│   │   └── index.html  # Главная страница
│   └── server.py       # FastAPI сервер
├── data/               # Данные
│   └── images/         # Изображения товаров
├── weights/            # Веса моделей
└── requirements.txt    # Зависимости проекта
```

## Технологический стек

- **FastAPI**: веб-фреймворк для создания API
- **PyTorch**: фреймворк машинного обучения
- **FAISS**: библиотека для эффективного поиска похожих векторов
- **Segment Anything Model (SAM)**: модель для сегментации изображений
- **BLIP**: модель для генерации описаний изображений
- **DistilBERT**: модель для обработки текста
- **ConvNext**: модель компьютерного зрения

## Основные функции

1. **Предсказание цены**
   - Анализ изображения товара
   - Определение категории и подкатегории
   - Генерация описания
   - Расчет предполагаемой цены

2. **Поиск похожих товаров**
   - Извлечение эмбеддингов изображений
   - Поиск топ-3 похожих товаров
   - Возврат изображений похожих товаров

3. **Сегментация изображений**
   - Выделение объекта на изображении
   - Поддержка точечных и прямоугольных подсказок
   - Возврат маски сегментации

## API Endpoints

### Web-интерфейс
- `GET /`: главная страница
- `POST /predict_for_web`: предсказание цены через веб-интерфейс

### Мобильное приложение
- `POST /predict_for_mobile`: предсказание цены для мобильного приложения
- `POST /segment`: сегментация изображения

## Установка и запуск

1. Установка зависимостей:
```bash
pip install -r requirements.txt
```

2. Запуск сервера:
```bash
uvicorn app.server:app --host 0.0.0.0 --port 8000
```
